{% extends 'base.html' %}

{% block title %}{{ idea.title }} - –°—Ç–∞—Ä—Ç–∞–ø –ò–¥–µ–∏{% endblock %}

{% block content %}
    <div class="idea-detail">
        <h1 class="idea-title">{{ idea.title }}</h1>

        <div class="idea-meta">
            –ê–≤—Ç–æ—Ä: {{ idea.author.username }} | {{ idea.date_posted.strftime('%d.%m.%Y %H:%M') }}
        </div>

        <div class="idea-content">
            {{ idea.description }}
        </div>

        <div class="votes">
            {% if 'user_id' in session %}
                <a href="{{ url_for('vote', idea_id=idea.id, value=1) }}" class="vote-btn">üëç –ó–∞</a>
                <span class="vote-count">{{ idea.vote_count }}</span>
                <a href="{{ url_for('vote', idea_id=idea.id, value=-1) }}" class="vote-btn">üëé –ü—Ä–æ—Ç–∏–≤</a>
            {% else %}
                <span>–ì–æ–ª–æ—Å–∞: {{ idea.vote_count }}</span>
                <p><small><a href="{{ url_for('login') }}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å</small></p>
            {% endif %}
        </div>

        <div class="comments">
            <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ ({{ idea.comments|length }})</h3>

            {% if 'user_id' in session %}
                <form method="POST" action="{{ url_for('add_comment', idea_id=idea.id) }}" class="comment-form">
                    <div>
                        <label for="content">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</label>
                        <textarea id="content" name="content" rows="3" required></textarea>
                    </div>
                    <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                </form>
            {% else %}
                <p><a href="{{ url_for('login') }}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å</p>
            {% endif %}

            {% if idea.comments %}
                {% for comment in idea.comments|sort(attribute='date_posted', reverse=true) %}
                    <div class="comment">
                        <div class="comment-content">
                            {{ comment.content }}
                        </div>
                        <div class="comment-meta">
                            - {{ comment.author.username }}, {{ comment.date_posted.strftime('%d.%m.%Y %H:%M') }}
                        </div>
                    </div>
                {% endfor %}
            {% else %}
                <p>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –ø–æ–∫–∞ –Ω–µ—Ç. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º, –∫—Ç–æ –ø—Ä–æ–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ—Ç —ç—Ç—É –∏–¥–µ—é!</p>
            {% endif %}
        </div>
    </div>

    <a href="{{ url_for('home') }}" class="back-btn">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –∏–¥–µ–π</a>
{% endblock %}
